package multiply

import (
	"context"
	"fmt"
	"image"
	"net/url"

	"github.com/aaronland/go-image/v2/transform"
)

// MultiplyTransformation is a struct that implements the `Transformation` interface for
// rotating images.
type MultiplyTransformation struct {
	transform.Transformation
	orientation string
}

func init() {
	ctx := context.Background()
	transform.RegisterTransformation(ctx, "multiply", NewMultiplyTransformation)
}

// NewMultiplyWriter returns a new `MultiplyTransformation` instance configure by 'uri'
// in the form of:
//
//	multiply://?
//
func NewMultiplyTransformation(ctx context.Context, uri string) (transform.Transformation, error) {

	_, err := url.Parse(uri)

	if err != nil {
		return nil, fmt.Errorf("Failed to parse URI, %w", err)
	}

	tr := &MultiplyTransformation{
	}

	return tr, nil
}

// Transform will multiply 'im' and return a new `image.Image` instance.
func (tr *MultiplyTransformation) Transform(ctx context.Context, im image.Image) (image.Image, error) {
	return Multiply(ctx, im, nil)
}
